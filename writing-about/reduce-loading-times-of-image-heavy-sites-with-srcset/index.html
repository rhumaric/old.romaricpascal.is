
<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .u-troisCoups body>* {
            visibility: hidden;
        }
    </style>
    <script>
        (function (window) {
            if (document.documentElement.classList) {
                window.troisCoups = {
                    reveal: function () {
                        document.documentElement.classList.remove('u-troisCoups');
                    }
                };


                document.documentElement.classList.add('u-troisCoups');
                setTimeout(window.troisCoups.reveal, 1500);
            }
        })(window);
    </script>

    <link rel="stylesheet" href="/wp-content/themes/romaricpascal.is/style.css">
    <link rel="alternate" type="application/rss+xml" title="Romaric Pascal | Lettering &amp; web development" href="/feed">

    <title>   Reduce loading times of image-heavy sites with `srcset` | Romaric Pascal</title>
    <meta name="description" content="Lettering &amp; web development">

    <link rel="apple-touch-icon" sizes="180x180" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/favicon-16x16.png">
<link rel="manifest" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/manifest.json">
<link rel="mask-icon" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/safari-pinned-tab.svg" color="#022950">
<link rel="shortcut icon" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/favicon.ico">
<meta name="msapplication-config" content="/wp-content/themes/romaricpascal.is/assets/images/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffc744">
    <!-- FB OpenGraph info -->
        <meta prefix="og:http://ogp.me/ns#" property="og:url" content="/writing-about/reduce-loading-times-of-image-heavy-sites-with-srcset/">
        <meta prefix="og:http://ogp.me/ns#" property="og:title" content="   Reduce loading times of image-heavy sites with `srcset` | Romaric Pascal">
    <meta prefix="og:http://ogp.me/ns#" property="og:description" content="Lettering &amp; web development">
    <meta prefix="og:http://ogp.me/ns#" property="og:image" content="/wp-content/themes/romaricpascal.is/assets/images/rp_with-padding_yellowbg_480.png">

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@romaricpascal" />
    <meta name="twitter:title" content="   Reduce loading times of image-heavy sites with `srcset` | Romaric Pascal" />
    <meta name="twitter:description" content="Lettering &amp; web development" />
    <meta name="twitter:image" content="/wp-content/themes/romaricpascal.is/assets/images/rp_with-padding_yellowbg_480.png" />

    <link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Romaric Pascal &raquo; Reduce loading times of image-heavy sites with `srcset` Comments Feed" href="/writing-about/reduce-loading-times-of-image-heavy-sites-with-srcset/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/romaricpascal.is\/wordpress\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.13"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='contact-form-7-css'  href='/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.9' type='text/css' media='all' />
<script type='text/javascript' src='/wordpress/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wordpress/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel="canonical" href="/writing-about/reduce-loading-times-of-image-heavy-sites-with-srcset/" />
  </head>
  <body class="post-template-default single single-post postid-1040 single-format-standard flexbug3Wrapper">
    <header id="#header" class="rp-Header">
        <a class="rp-Logo" href="" title="Home">
    <img src="/wp-content/themes/romaricpascal.is/assets/images/rp-letters_144.png" alt="R-P monogram">
</a>
<nav class="rp-BreadcrumbNav">
    <div class="rp-CollapsedItemsMenu">
        <a class="rp-BreadcrumbLink rp-CollapsedItemsMenuToggle js-toggle" data-toggle-group="overlays" data-toggle-target=".rp-CollapsedItems">
            <span class="rp-BreadcrumbLinkSeparator"></span>
            <span class="rp-BreadcrumbLink__title">...</span>
        </a>
        <div class="rp-CollapsedItems js-outsideToggle"></div>
    </div>
    <div class="rp-BreadcrumbNavItems js-collapsible">
				<a href="/writing-about/" class="rp-BreadcrumbLink">
			<span class="rp-BreadcrumbLinkSeparator"></span>
			<span class="rp-BreadcrumbLink__title">Posts</span>
		</a>
		    </div>
</nav>      <nav class="rp-MainNav">
        <a class="t-hidden-visually" tabindex="1" href="#content">Skip to content</a>
        <a href="#main-nav" class="js-toggle" data-toggle-group="overlays" data-toggle-target=".rp-MenuContainer">Menu</a>
        <div class="rp-MenuContainer js-outsideToggle" id="main-nav">
        <a class="rp-NavLogo" href="" title="Home">
            <img src="/wp-content/themes/romaricpascal.is/assets/images/rp-knockout_shade_144.png" alt="Home">
        </a>
        <div class="menu-site-navigation-container"><ul id="menu-site-navigation" class="rp-Menu rp-Header__menuI"><li id="menu-item-936" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-936"><a href="/">Home</a></li>
<li id="menu-item-960" class="menu-item menu-item-type-post_type_archive menu-item-object-project menu-item-has-children menu-item-960"><a href="/proud-of/">Portfolio</a>
<ul  class="sub-menu">
	<li id="menu-item-942" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-942"><a href="/proud-of/logo-brand-designs">Logo &#038; Brand</a></li>
	<li id="menu-item-954" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-954"><a href="/proud-of/tshirts-merch-designs/">T-shirts &#038; merch</a></li>
	<li id="menu-item-957" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-957"><a href="/proud-of/print-illustration-designs">Print &#038; illustration</a></li>
</ul>
</li>
<li id="menu-item-964" class="menu-item menu-item-type-post_type_archive menu-item-object-artwork menu-item-964"><a href="/drawing-letters/">Artworks</a></li>
<li id="menu-item-935" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-935"><a href="/writing-about/">Blog</a></li>
<li id="menu-item-933" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-933"><a href="/happy-to-chat/">Contact</a></li>
<li id="menu-item-1022" class="menu-item menu-item-type-taxonomy menu-item-object-craft current-post-ancestor current-menu-parent current-post-parent menu-item-1022"><a href="/writing-about/craft/web/">Web</a></li>
<li id="menu-item-934" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-934"><a target="_blank" href="/selling-nice-stuff/">Shop</a></li>
</ul></div>        <a class="rp-MenuToggle js-toggle" href="#" data-toggle-group="overlays" data-toggle-target=".rp-MenuContainer">Close menu</a>
        <small class="rp-Legal l-Container">¬© Romaric Pascal (trading name of <a href="https://beta.companieshouse.gov.uk/company/08544032">Rhumaric Ltd</a>)</small>
        </div>
      </nav>
    </header>
    <div class="rp-Viewport l-vertCentered u-mh-100vh">


<article class="rp-Content">
  <header class="rp-HeaderWithSubhead u-mb-2">
    <h1 class="rp-HeaderWithSubhead__heading">
        Reduce loading times of image-heavy sites with `srcset`    </h1>
    <p><time datetime="2017-09-26T12:52:52+00:00">26 Sep 2017</time> ‚Äî An article about: <a href="/writing-about/craft/web/" rel="tag">Web</a> - <a href="/writing-about/category/images/" rel="category tag">Images</a> - <a href="/writing-about/category/performances/" rel="category tag">Performances</a></p>
  </header>
  <main>
    <style>
code { font-size: 135%; font-weight: bold; }
</style>
<p>This is the first article of a small series about techniques for keeping the loading times of image-heavy websites in check. Lots of images mean more KB to download for the browser. And in turn, longer loading times.</p>
<p>An obvious answer to the problem would be to cut down the number of images. But on some websites (this portfolio, for example) images are one of the main part of the content. Let&rsquo;s see what we can do to keep things light.</p>
<blockquote style="margin-left: 0;margin-right: 0;padding: 1em;background: #FEE7B0;border-left: 5px solid #DCCCB1;font-size: 1.1em;">
<p>Use images at the right resolution in the right format </p>
</blockquote>
<p>For the first download at least, it pretty much comes down to that (you can set up caching rules to make future loads faster). Let&rsquo;s leave the &ldquo;right format&rdquo;  to its own future article (between vector or raster, optimised images, new formats like WebP and the <code>&lt;picture&gt;</code> element there&rsquo;s a fair bit to explore). This article will focus on the &ldquo;right resolution&rdquo; bit.</p>
<p>Loading an HD image when it&rsquo;s only displayed 200px wide has several issues:</p>
<ul>
<li>it makes users wait, augmenting the risk of abandoning their visit</li>
<li>it needs more bandwidth, making users pay unnecessarily for their visit</li>
<li>it requires the browser to resize it heavily, making their device use more battery</li>
</ul>
<p>This article will also only deal with content images (<code>&lt;img&gt;</code> tags). A future one will deal with those that are in the CSS.</p>
<h2 id="the-problem"><a name="user-content-the-problem" href="#the-problem" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>The problem</h2>
<p>This &ldquo;right resolution&rdquo; is not quite easy to pin, with websites getting accessed through a wide variety of devices:</p>
<ul>
<li>with different screen sizes,</li>
<li>and different pixel density.</li>
</ul>
<p>This means there won&rsquo;t be a unique &ldquo;right resolution&rdquo;. An image that 400px wide on a phone screen might get a much larger share of the screen on a desktop monitor.</p>
<p>Historically, the <code>&lt;img&gt;</code> tag only had the <code>src</code> attribute to provide the image URL. So which one to choose? A low res image will look terrible when scaled up on large displays. But a large image will blow up the loading times üôÅ</p>
<h2 id="srcset-to-the-rescue"><code>srcset</code> to the rescue</h2>
<p>What if we could let the browser choose? Give it a list of image URLs with different resolutions and let it pick which is the most appropriate to load. It&rsquo;s well aware of the device that&rsquo;s using it after all. Way more than the server it&rsquo;s requesting the image to.</p>
<p>This is exactly the role of the <code>srcset</code> attribute on the <code>&lt;img&gt;</code> tag. Inside, you can list additional URLs the browser can load instead of the <code>src</code> one. Each is associated with a width or pixel density which will help the browser make its choice.</p>
<p>To pick an image with the appropriate width, though, the browser will need a bit more help. Viewing the website in a 1080px wide browser doesn&rsquo;t mean all images will be 1080px wide. So we need to add some more hints with the <code>sizes</code> attribute. It contains a list of media queries (just like in CSS) to tell the browser which image to look for in the <code>srcset</code> depending on the situation. First match goes! (unlike in CSS).</p>
<p>This leads to markup that looks like that:</p>
<pre style="margin-left: 0;margin-right: 0;padding: 1em;background: #FEE7B0;border-left: 5px solid #DCCCB1;">
<code class="html">&lt;img 
  src=&quot;/images/funnycat-200x150.jpg&quot;
  height=&quot;150&quot;
  width=&quot;200&quot;
  srcset=&quot;/images/funnycat-400x300.jpg 400w,
          /images/funnycat-800x600.jpg 800w,
          /images/funnycat-800x600.jpg 3x&quot;
  sizes=&quot;(min-width: 1600px) 800px,
         (min-width: 800px) 400px,
         200px&quot;&gt;
</code></pre>
<p>With this, the browser can say &ldquo;hey! my screen is between 800 and 1600px wide. I can use the <code>funnycat-400x300.jpg</code> image instead of the <code>src</code> one&rdquo;.</p>
<p>A couple of things to note:</p>
<ul>
<li>the width in the <code>srcset</code> are suffixed by <code>w</code>, but they&rsquo;re actual CSS length in the <code>sizes</code> attributes. Easy to mix them up, so watch out! On the plus side, that means you can <code>calc()</code> things in the <code>sizes</code>.</li>
<li>the <code>src</code> is not necessarily the smallest image. A few browser don&rsquo;t support <code>srcset</code> (<a href="http://caniuse.com/#search=srcset" target="blank" rel="noopener">IE, Edge 15 and before, and Opera Mini</a> as I&rsquo;m writing this). They&rsquo;ll just use <code>src</code>, so a compromise will be needed between quality and load times there.</li>
<li>to follow the specs, the original <code>src</code> image must not appear in the <code>srcset</code> (nor should there be duplicate entries). Doesn&rsquo;t seem to break the behaviour, just make the markup invalid.</li>
<li>to follow the specs again, if there are widths in the <code>srcset</code>, <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#attr-img-sizes" target="blank" rel="noopener">the <code>sizes</code> attribute must be present</a>. Didn&rsquo;t seem to break things either, just use the whole viewport width to pick the image width.</li>
</ul>
<h2 id="adding-the-srcset-attribute-to-your-site"><a name="user-content-adding-the-srcset-attribute-to-your-site" href="#adding-the-srcset-attribute-to-your-site" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Adding the <code>srcset</code> attribute to your site</h2>
<p>From a practical point of view, implementing <code>srcset</code> in your design is best done once the CSS has been finalised (or at least finalised enough for the image sizes to be set in stone).</p>
<h3 id="making-an-image-width-inventory"><a name="user-content-making-an-image-width-inventory" href="#making-an-image-width-inventory" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Making an image width inventory</h3>
<p>The first step is making an inventory of the image sizes for the different pages of your website at different screen sizes. Unfortunately, I don&rsquo;t know of any crawler that does that automatically (that would be ideal, if you know of one, <a href="[/happy-to-chat]">please let me know</a>!), so it&rsquo;ll have to be a manual process.</p>
<p>There&rsquo;s no need to go through each page, though. Only each &ldquo;template&rdquo;. And equally, there&rsquo;s no need to go through the whole width spectrum as you know the breakpoints in your CSS. </p>
<p>Some images might also be percent or viewport unit based. For those, you&rsquo;ll need to decide of size increments to adapt the served asset to the final design, just like more &ldquo;fixed&rdquo; images.</p>
<h3 id="aggregating-the-sizes"><a name="user-content-aggregating-the-sizes" href="#aggregating-the-sizes" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Aggregating the sizes</h3>
<p>The inventory might leave you with quite a collection of sizes. In an ideal world, you&rsquo;d provide each <code>&lt;img&gt;</code> tag its very own list of URLs and sizes. That can quickly lead to a maintenance overhead:</p>
<ul>
<li>generating and storing/caching of the images,</li>
<li>filling the <code>srcset</code> and <code>sizes</code> attributes accurately.</li>
</ul>
<p>To ease the burden a bit, you can regroup the sizes into similar sizes to reduce the number of images you have to handle. This might mean a few more pixels to download as the price of an easier maintenance. You&rsquo;ll have to weight if the trade-off is worth it.</p>
<h3 id="plan-for-different-pixel-densities"><a name="user-content-plan-for-different-pixel-densities" href="#plan-for-different-pixel-densities" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Plan for different pixel densities</h3>
<p>We now have a list of the images sizes we&rsquo;ll be implementing for our design. This is time to think of screens with high pixel density and not forget to plan for 2x and 3x versions of these images.</p>
<p>With a little <del>luck</del><ins>planning</ins>, these 2x and 3x might even match some of the other sizes, which will lower the number of images to generate.</p>
<h3 id="generate-the-images-and-write-the-srcset-and-sizes-attributes"><a name="user-content-generate-the-images-and-write-the-srcset-and-sizes-attributes" href="#generate-the-images-and-write-the-srcset-and-sizes-attributes" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Generate the images and write the <code>srcset</code> and <code>sizes</code> attributes</h3>
<p>These last two part will very much depend on how your website is set up.</p>
<p>For the generation, exporting every size from your favourite image editor will be tedious. I&rsquo;d recommend leaving that to your CMS, some scripts or a SaaS platform.</p>
<p>Once all your images are ready, you can add the attributes to the markup and voila! Your users will load the appropriate image for their screen!</p>
<h2 id="in-the-end"><a name="user-content-in-the-end" href="#in-the-end" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>In the end</h2>
<p>The <code>srcset</code> attribute is a great way to shave some KB of download for your users by making your website load just the right image for the screen it&rsquo;s viewed in. Of course, associating the screen size to the bandwidth available (and in turn loading time) is not a perfect correlation. But it&rsquo;s a good place to start.</p>
<p>Hope this article was helpful to you. If you want to chat about it, feel free to <a href="/happy-to-chat">get in touch here</a> or on <a href="//twitter.com/romaricpascal">Twitter</a>.  </p>
  </main>
  <aside>

  </aside>
  <nav class="rp-PrevNextNav">
		<a class="rp-PrevNextLink rp-PrevNextLink-prev rp-PrevNextNav__previous" 
	   href="/writing-about/lettering-for-the-web/"
	   rel="prev"
	   	   accesskey="j"
	   data-key="left"
			   title="Lettering for the web">
	   	title	</a>
		<a class="rp-PrevNextLink rp-PrevNextLink-next rp-PrevNextNav__next" 
	   href="/writing-about/inktober-a-look-back-at-2016/"
	   rel="next"
	   		accesskey="k"
	   	data-key="right"
			   title="Inktober - A look back at 2016">
	   	title	</a>
</nav>
</article>

  </div>
  <script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/romaricpascal.is\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}}};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.9'></script>
  <script defer src="/wp-content/themes/romaricpascal.is/main.js"></script>
</body>
