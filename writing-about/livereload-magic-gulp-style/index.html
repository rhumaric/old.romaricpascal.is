<!doctype html><html lang="en-US"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .u-troisCoups body>* {
            visibility: hidden;
        }
    </style>
    <script>
        (function (window) {
            if (document.documentElement.classList) {
                window.troisCoups = {
                    reveal: function () {
                        document.documentElement.classList.remove('u-troisCoups');
                    }
                };


                document.documentElement.classList.add('u-troisCoups');
                setTimeout(window.troisCoups.reveal, 1500);
            }
        })(window);
    </script>

    <link rel="stylesheet" href="/wp-content/themes/romaricpascal.is/style.css">
    <link rel="alternate" type="application/rss+xml" title="Romaric Pascal | Lettering &#x26; web development" href="/feed">

    <title>   Livereload magic, Gulp style! | Romaric Pascal</title>
    <meta name="description" content="Lettering &#x26; web development">

    <link rel="apple-touch-icon" sizes="180x180" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/favicon-16x16.png">
<link rel="manifest" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/manifest.json">
<link rel="mask-icon" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/safari-pinned-tab.svg" color="#022950">
<link rel="shortcut icon" href="/wp-content/themes/romaricpascal.is/assets/images/favicons/favicon.ico">
<meta name="msapplication-config" content="/wp-content/themes/romaricpascal.is/assets/images/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffc744">
    <!-- FB OpenGraph info -->
        <meta prefix="og:http://ogp.me/ns#" property="og:url" content="/writing-about/livereload-magic-gulp-style/">
        <meta prefix="og:http://ogp.me/ns#" property="og:title" content="   Livereload magic, Gulp style! | Romaric Pascal">
    <meta prefix="og:http://ogp.me/ns#" property="og:description" content="Lettering &#x26; web development">
    <meta prefix="og:http://ogp.me/ns#" property="og:image" content="/wp-content/themes/romaricpascal.is/assets/images/rp_with-padding_yellowbg_480.png">

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@romaricpascal">
    <meta name="twitter:title" content="   Livereload magic, Gulp style! | Romaric Pascal">
    <meta name="twitter:description" content="Lettering &#x26; web development">
    <meta name="twitter:image" content="/wp-content/themes/romaricpascal.is/assets/images/rp_with-padding_yellowbg_480.png">

    <link rel="dns-prefetch" href="//s.w.org">

		
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>



<link rel="canonical" href="/writing-about/livereload-magic-gulp-style/">
  </head>
  <body class="post-template-default single single-post postid-462 single-format-standard flexbug3Wrapper">
    <header id="#header" class="rp-Header">
        <a class="rp-Logo" href="" title="Home">
    <img src="/wp-content/themes/romaricpascal.is/assets/images/rp-letters_144.png" alt="R-P monogram">
</a>
<nav class="rp-BreadcrumbNav">
    <div class="rp-CollapsedItemsMenu">
        <a class="rp-BreadcrumbLink rp-CollapsedItemsMenuToggle js-toggle" data-toggle-group="overlays" data-toggle-target=".rp-CollapsedItems">
            <span class="rp-BreadcrumbLinkSeparator"></span>
            <span class="rp-BreadcrumbLink__title">...</span>
        </a>
        <div class="rp-CollapsedItems js-outsideToggle"></div>
    </div>
    <div class="rp-BreadcrumbNavItems js-collapsible">
				<a href="/writing-about/" class="rp-BreadcrumbLink">
			<span class="rp-BreadcrumbLinkSeparator"></span>
			<span class="rp-BreadcrumbLink__title">Posts</span>
		</a>
		    </div>
</nav>      <nav class="rp-MainNav">
        <a class="t-hidden-visually" tabindex="1" href="#content">Skip to content</a>
        <a href="#main-nav" class="js-toggle" data-toggle-group="overlays" data-toggle-target=".rp-MenuContainer">Menu</a>
        <div class="rp-MenuContainer js-outsideToggle" id="main-nav">
        <a class="rp-NavLogo" href="" title="Home">
            <img src="/wp-content/themes/romaricpascal.is/assets/images/rp-knockout_shade_144.png" alt="Home">
        </a>
        <div class="menu-site-navigation-container"><ul id="menu-site-navigation" class="rp-Menu rp-Header__menuI"><li id="menu-item-936" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-936"><a href="/">Home</a></li>
<li id="menu-item-960" class="menu-item menu-item-type-post_type_archive menu-item-object-project menu-item-has-children menu-item-960"><a href="/proud-of/">Portfolio</a>
<ul class="sub-menu">
	<li id="menu-item-942" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-942"><a href="/proud-of/logo-brand-designs">Logo &#x26; Brand</a></li>
	<li id="menu-item-954" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-954"><a href="/proud-of/tshirts-merch-designs/">T-shirts &#x26; merch</a></li>
	<li id="menu-item-957" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-957"><a href="/proud-of/print-illustration-designs">Print &#x26; illustration</a></li>
</ul>
</li>
<li id="menu-item-964" class="menu-item menu-item-type-post_type_archive menu-item-object-artwork menu-item-964"><a href="/drawing-letters/">Artworks</a></li>
<li id="menu-item-935" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-935"><a href="/writing-about/">Blog</a></li>
<li id="menu-item-933" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-933"><a href="/happy-to-chat/">Contact</a></li>
<li id="menu-item-1022" class="menu-item menu-item-type-taxonomy menu-item-object-craft current-post-ancestor current-menu-parent current-post-parent menu-item-1022"><a href="/writing-about/craft/web/">Web</a></li>
<li id="menu-item-934" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-934"><a target="_blank" href="/selling-nice-stuff/">Shop</a></li>
</ul></div>        <a class="rp-MenuToggle js-toggle" href="#" data-toggle-group="overlays" data-toggle-target=".rp-MenuContainer">Close menu</a>
        <small class="rp-Legal l-Container">© Romaric Pascal (trading name of <a href="https://beta.companieshouse.gov.uk/company/08544032">Rhumaric Ltd</a>)</small>
        </div>
      </nav>
    </header>
    <div class="rp-Viewport l-vertCentered u-mh-100vh">


<article class="rp-Content">
  <header class="rp-HeaderWithSubhead u-mb-2">
    <h1 class="rp-HeaderWithSubhead__heading">
        Livereload magic, Gulp style!    </h1>
    <p><time datetime="2014-01-22T16:27:51+00:00">22 Jan 2014</time> — An article about: <a href="/writing-about/craft/web/" rel="tag">Web</a> - <a href="/writing-about/category/uncategorized/" rel="category tag">Uncategorized</a></p>
  </header>
  <main>
    <p>There's been a new name making some buzz in world of JS task runners lately: <a href="http://gulpjs.com/">Gulp</a>. Curious, I've given it a quick go to see how hard it would be to get the <a href="/keeping-old-stuff/renewing-the-grunt-livereload-magic/">minimal express &#x26; livereload setup I did with Grunt</a>.</p>
<h2 id="what&#x27;s-that-gulp-thing">What's that Gulp thing</h2>
<p>Pretty much like Grunt, Gulp allows you to define a set of tasks and run them from the command line. The most interesting point for me was the structure of the configuration file, which is more “programmatic” and less declarative. I find this makes things easier to read, but this is pretty subjective ;). Gulp is also meant to work a lot with streams doing small processings, `pipe()`-ing them to one another to create small treatment pipelines for each task. This apparently adds some performance improvements to the readability, though I have not really paid attention to that. To give a quick example, this is how a <a href="https://gist.github.com/rhumaric/8559206#file-jshint-task-example-js">Gulp task for Javascript validation with JSHint</a> looks like:</p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=jshint-task-example.js"></script></p>
<h2 id="a-bit-of-setup">A bit of setup</h2>
<p>So let's get started on this Gulp + Express + Livereload configuration. We'll split this in two steps and start with the Express setup. Then we’ll add the livereload configuration.</p>
<p>But first of all, you'll need the <code>gulp</code> CLI installed on your system. A quick <code>npm</code> call will sort that (don't forget to <code>sudo</code> if your system requires it, I always do :s): <code>npm install -g gulp</code>.</p>
<p>Now the <code>gulp</code> command is available, let's bootstrap our project. As a starting point, we’ll use a simple folder containing:</p>
<ul>
<li>an <code>index.html</code> file (content is up to you, just make sure it has a <code>&#x3C;body></code>),</li>
<li>a <code>package.json</code> file to store the project's dependencies (<code>npm init</code> will help you scaffold one),</li>
<li>a local install of <code>gulp</code> in your project (<code>npm install gulp</code> from your project's folder, no <code>-g</code> this time),</li>
<li>a <code>Gulpfile.js</code> file to store Gulp configuration:</li>
</ul>
<p>If you don’t want to leave your Gulpfile empty and already start playing with Gulp, you could fill it with the following <a href="https://gist.github.com/rhumaric/8559206#file-gulpfile-initial-js">code that provides a default “Hello world”-ish Gulp task</a>. To run your “build”, just go <code>gulp</code> in your command line. As the command provides no specific task, it will run whatever <code>default</code> defines.</p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=Gulpfile.initial.js"></script></p>
<h2 id="express-setup">Express setup</h2>
<p>To get <a href="http://expressjs.com">Express</a> to host our project's file, we'll need a new dependency in the project. Let's just <code>npm install express --save-dev</code>
</p>
<p>You'll notice we're installing the actual <code>express</code> package and not a specific plugin for Gulp. Gulp encourages to use the libraries as is when the task has nothing to do with manipulating streams, like popping up a web server, launching tests… This makes running Express with Gulp pretty much the same as when creating a standalone Express app. This gives us the following <a href="https://gist.github.com/rhumaric/8559206#file-gulpfile-express-js">Gulp configuration to start up Express.</a></p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=Gulpfile.express.js"></script></p>
<p>The <code>gulp</code> command now pops up a server, and if you point your browser to <a href="https://localhost:4000" rel="nofollow">https://localhost:4000</a>, you should see the content of you <code>index.html</code></p>
<p>The express startup could also have been a task of its own. We'd just needed to wrap it in a <code>gulp.task</code> call. Then we could have called it via <code>gulp.run</code> inside the default task. It all depends on wether you need to launch express on its own or just use it when running other tasks.</p>
<h2 id="adding-some-livereload-magic">Adding some livereload magic</h2>
<p>As for starting up an Express server, starting up a livereload server doesn't have much to do with manipulating streams. This means no need for a specific Gulp plugin, we'll just use <code>tiny-lr</code>. We'll also need the <code>connect-livereload</code> middleware to inject the Javascript communicating with livereload in the pages served by Express. So let's add these dependencies:</p>
<p><code>npm install tiny-lr connect-livereload --save-dev</code></p>
<p>This makes us 3 steps away from having livereload set up. First on, starting up livereload! As with Express, we'll wrap <a href="https://gist.github.com/rhumaric/8559206#file-tinylr-snippet-js">tinylr bootstrap in a specific function</a> (don’t forget to call it in the <code>default</code> task 😉 ).</p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=tinylr.snippet.js"></script></p>
<p><code>gulp</code> now starts up two services: Express on port 4000 and tinylr on port 35729. If you go to <a href="https://localhost:35729" rel="nofollow">https://localhost:35729</a>, you’ll get a warm JSON welcome from <code>tiny-lr</code>.</p>
<p>Next step is to get express to inject the livereload JS snippet in the HTML it serves. You can skip this if you're using a browser plugin to communicate with the livereload server. This is the job of the <code>connect-livereload</code> middleware. We just need to load it <strong>before</strong> the the <code>static()</code> configuration, which makes the <a href="https://gist.github.com/rhumaric/8559206#file-express-livereload-snippet-js"><code>startExpress()</code> function</a> look like this:</p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=express-livereload.snippet.js"></script></p>
<p>The pages served by Express now have a small bit of JS injected just before their <code>body</code> closing tag. This will make them react to the livereload updates. All that's left now is sending livereload notification when file changes. Gulp comes in with a built in <code>watch()</code>method, so let’s take advantage of this and make a <a href="https://gist.github.com/rhumaric/8559206#file-gulpfile-final-js">final update to our Gulpfile</a>:</p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=Gulpfile.final.js"></script></p>
<h2 id="what-about-gulp-livereload-?">What about gulp-livereload ?</h2>
<p>If you look up on the NPM registry, you'll find a plugin for Gulp called <code>gulp-livereload</code>. It allows you to send notifications to the livereload server as part of your <code>pipe()</code> chain. This would make the <a href="https://gist.github.com/rhumaric/8559206#file-gulp-livereload-snippet-js"><code>notifyLivereload()</code> function a bit more concise:</a></p>
<p><script src="https://gist.github.com/rhumaric/8559206.js?file=gulp-livereload.snippet.js"></script></p>
<p>As we’re not doing much with our HTML file in the current Gulpfile, this approach does not bring much besides conciseness. But when processing files more heavily, it saves you from having to watch both the source files and their processed results. You can just pipe to <code>gulp-livereload</code> once you’ve gone through, say, LESS processing and CSS minification, instead of monitoring the <code>.less</code> to trigger the processing, and the <code>.css</code> files to trigger livereload.</p>
<h2 id="wrapping-it-up!">Wrapping it up!</h2>
<p>Reproducing the express and livereload configuration I usually run with Grunt turned out pretty simple. I’m now really looking forward to trying out Gulp with the whole stream piping shebang to process my builds. The Gulpfile ends up maybe a bit more verbose than the Gruntfile, but I find function calls way more easy to read than lots of nested Javascript objects. But in the end, it’s as personal (well, sometimes “team-personal” :p) as any other tool choices: it’s just about what features it provides and how easy you find it to use.</p>
<p>Thanks for staying till the end! Happy Coding 😉</p>
  </main>
  <aside>

  </aside>
  <nav class="rp-PrevNextNav">
		<a class="rp-PrevNextLink rp-PrevNextLink-prev rp-PrevNextNav__previous" href="/writing-about/building-a-yeoman-generator/" rel="prev" accesskey="j" data-key="left" title="Building a Yeoman generator">
	   	title	</a>
		<a class="rp-PrevNextLink rp-PrevNextLink-next rp-PrevNextNav__next" href="/writing-about/quick-tip-console-logs-with-conditional-breakpoints/" rel="next" accesskey="k" data-key="right" title="Quick tip: console logs with conditional breakpoints">
	   	title	</a>
</nav>
</article>

  </div>
  

  <script defer src="/wp-content/themes/romaricpascal.is/main.js"></script>

</body></html>